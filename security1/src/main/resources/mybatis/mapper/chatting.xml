<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 매퍼파일 -->
<mapper namespace="com.security.websocket.chat.dao.ChatMapper">
	<select id="findChatListByNo" parameterType="int" resultType="ChatListDto">
		SELECT chatting_nick
				,c.chatting_no chatting_no
				,(SELECT count(chatting_no) FROM chatting_list WHERE chatting_no = c.chatting_no GROUP BY chatting_no) count 
		FROM chatting_list cl, chatting c 
		WHERE cl.chatting_no = c.chatting_no 
			AND cl.account_no = #{accountNo}
	</select>
	<insert id="insertChat" parameterType="ChatDto">
		INSERT INTO chatting_chatroom VALUES(seq_chatroom.nextval,#{chattingNo},#{accountNo},default,#{chatComment},null,null)
	</insert>
</mapper>